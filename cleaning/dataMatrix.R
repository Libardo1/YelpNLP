load("../data/data.rda")

# All-lowercase variant of data.rda for ease in matching strings
dataLower = tolower(data$text)

# Helper function that returns the count of appearances of a string
count = function(x, text) {
  sapply(text, function(y) sum(gregexpr(x, y)[[1]] > 0))
}

# Helper function that returns whether or not a string appears
exist = function(x) {
  as.factor(grepl(x, dataLower))
}

dataRev = data.frame(rating = data$starsF)
dataRev$delicious = exist(" deli(cious|sh)")
dataRev$friendly = exist(" friendly")
dataRev$affordable = exist(" affordable")
dataRev$filled = exist(" f[ui]ll")
dataRev$best = exist("[^(not|far from)]( the)? best")
dataRev$awesome = exist(" awesome")
dataRev$huge = exist(" huge")
dataRev$good = exist(" good")
dataRev$wonderful = exist(" wonderful")
dataRev$mom = exist(" mom")
dataRev$thanks = exist(" thanks")
dataRev$like = exist(" like")
dataRev$refreshing = exist(" refreshing")
dataRev$homestyle = exist("home[- ]?(cooked|made|style)")
dataRev$love = exist(" love")
dataRev$enjoy = exist(" enjoy")
dataRev$glad = exist(" glad")
dataRev$nice = exist(" nice")
dataRev$tasty = exist(" tasty")
dataRev$relax = exist(" relax")
dataRev$excellent = exist(" excellent")
dataRev$accomodate = exist(" accomodat(ed|ing)")
dataRev$exclamation = count("!", dataLower) / count("[\\.!]", dataLower)
dataRev$topnotch = exist(" top[- ]?notch")
dataRev$welcome = exist(" welcom(e|ed|ing)")
dataRev$memories = exist(" memories")
dataRev$fond = exist(" fond ")
dataRev$uppercase = count("[[:upper:]]", data$text) / count("[[:alpha:]]", dataLower)
dataRev$crispy = exist(" crispy")
dataRev$happyhour = exist(" happy[- ]?hour")
dataRev$great = exist(" great")
dataRev$handsdown = exist(" hands[- ]?down")
dataRev$colddrinks = exist("cold (beer|drinks|beverages)")
dataRev$engaging = exist(" engaging")
dataRev$quickly = exist(" quick(ly)?")
dataRev$bigscreen = exist(" big[- ]?screen")
dataRev$free = exist(" free")
dataRev$clean = exist(" clean")
dataRev$pleasing = exist(" pleasing")
dataRev$endless = exist(" endless")
dataRev$highly = exist(" highly")
dataRev$convenient = exist(" convenient")
dataRev$packed = exist(" packed")
dataRev$hungry = exist(" (hungry|starving|famished)")
dataRev$favorite = exist(" favorite")
dataRev$hot = exist(" hot")
dataRev$surprising = exist(" surprising")
dataRev$fresh = exist(" fresh")
dataRev$cheap = exist(" cheap")
dataRev$thank = exist(" thank")
dataRev$yum = exist(" (yum|nom)")
dataRev$happy = exist(" (happy|satisfied)")
dataRev$a_must = exist("a must")
dataRev$overflow = exist(" overflow")
dataRev$busy = exist(" busy")
dataRev$classy = exist(" classy")
dataRev$healthy = exist(" healthy")
dataRev$five_star = exist("(five|5)[- ]?(star|out|/5)")
dataRev$four_star = exist("(four|4)[- ]?(star|out|/5)")
dataRev$three_star = exist("(three|3)[- ]?(star|out|/5)")
dataRev$two_star = exist("(two|2)[- ]?(star|out|/5)")
dataRev$one_star = exist("(one|1)[- ]?(star|out|/5)")
dataRev$regular = exist(" regular")
dataRev$crumb = exist(" crumb")
dataRev$real_butter = exist(" real butter")
dataRev$advice = exist(" advi[sc]e")
dataRev$cant_wait = exist(" (cant|cannot|couldnt|not) wait")
dataRev$unpretentious = exist("unpretentious")
dataRev$exactly = exist("exactly")
dataRev$rich = exist(" rich[,\\. ]")
dataRev$free_parking = exist("(plenty|of|free) parking")
dataRev$attentive = exist("[^(in|not |un)]attentive")
dataRev$pleasant = exist("[^(not |un)]pleasant")
dataRev$efficient = exist("[^(not |in)]efficient")
dataRev$outstanding = exist(" outstanding")
dataRev$flavorful = exist(" flavorful")
dataRev$fabulous = exist(" fabulous")
dataRev$local = exist(" local")
dataRev$perfect = exist("perfect")
dataRev$ambience = exist(" ambi[ae]n(ce|t)")
dataRev$totally = exist("totally")
dataRev$worth = exist("[^(not)] worth")
dataRev$world = exist(" world")
dataRev$nostalgia = exist(" nostalgia")
dataRev$wifi = exist(" wi[- ]?fi")
dataRev$gem = exist(" gem")
dataRev$recommend = exist("recommend")
dataRev$juicy = exist(" juicy")
dataRev$authentic = exist(" authentic")
dataRev$amazing = exist("amazing")
dataRev$plague = exist("plague")
dataRev$popular = exist("[^(not |un)]popular")
dataRev$atmosphere = exist(" atmosphere")
dataRev$late = exist(" late")
dataRev$consistent = exist("[^(not |in)]consistent")
dataRev$tip = exist(" tip")
dataRev$impress = exist(" impress")
dataRev$fantastic = exist("fantastic")
dataRev$cozy = exist("cozy")
dataRev$atmosphere = exist(" atmosphere")
dataRev$beautiful = exist("beautiful")
dataRev$forever = exist("forever")
dataRev$tender = exist("tender[^s]")
dataRev$aroma = exist("aroma")
dataRev$charming = exist("charming")
dataRev$reasonable = exist("[^(not |un)]reasonabl[ey]")
dataRev$clean = exist("[^(not |un)]clean")
dataRev$cash_only = exist(" cash[- ]?only")
dataRev$close = exist(" clos(e|ed|ing)")
dataRev$hit = exist(" hit.*miss")
dataRev$enough = exist(" enough")
dataRev$hate = exist(" hate")
dataRev$lack = exist(" lack")
dataRev$worst = exist(" wors[te]")
dataRev$disappoint = exist(" disappoint(ment|ing)")
dataRev$understaff = exist(" understaff")
dataRev$ridiculous = exist(" ridiculous")
dataRev$dissatisfied = exist(" dissatisfied")
dataRev$dirty = exist(" dirty")
dataRev$ellips2s = exist("\\.\\.\\.*")
dataRev$terrible = exist(" terrible")
dataRev$average = exist(" average")
dataRev$inferior = exist(" inferior")
dataRev$canned = exist(" canned")
dataRev$grease = exist(" greas[ey]")
dataRev$disgusting = exist(" disgust[ing|ed]?")
dataRev$only = exist(" only")
dataRev$bad = exist(" bad")
dataRev$typical = exist(" typical")
dataRev$never = exist(" never")
dataRev$another_try = exist(" (another|more|second) (try|chance)")
dataRev$long = exist(" long")
dataRev$clue = exist(" clue")
dataRev$nah = exist("nah")
dataRev$tiny = exist(" tiny")
dataRev$naive = exist("naive")
dataRev$slow = exist(" slow")
dataRev$noisy = exist(" noisy")
dataRev$however = count(" (however|but|though|although)", dataLower)
dataRev$drawback = exist(" drawback")
dataRev$cooked = exist(" [^(under)]cook[ed]?")
dataRev$no_bathroom = exist(" no ((bath|rest|wash)room|toilet)")
dataRev$cramped = exist(" cramped")
dataRev$undercook = exist(" undercook[ed]?")
dataRev$raw = exist(" raw")
dataRev$unfortunate = exist(" unfortunate")
dataRev$not_worth = exist(" not worth")
dataRev$small = exist(" small")
dataRev$grimy = exist(" (gr|sl)imy")
dataRev$dark = exist(" dark")
dataRev$hole = exist(" hole")
dataRev$stand = exist(" stand")
dataRev$plain = exist(" plain")
dataRev$rude = exist(" rude")
dataRev$decent = exist(" decent")
dataRev$nothing_special = exist(" n[[:alpha:]]* special")
dataRev$boring = exist(" boring")
dataRev$avoid = exist(" avoid")
dataRev$filthy = exist(" filthy")
dataRev$unable = exist(" unable")
dataRev$overX = exist(" over[[:alpha:]]*")
dataRev$confusing = exist(" confus(ing|ed)")
dataRev$yell = exist(" yell")
dataRev$no = exist(" no ")
dataRev$at_best = exist(" at best")
dataRev$horrible = exist(" horrible")
dataRev$sadface = exist("(-_+-|\\):|:\\(|D:)")
dataRev$waste = exist(" waste")
dataRev$tasteless = exist(" tasteless")
dataRev$cold = exist(" cold")
dataRev$tasteless = exist(" tasteless")
dataRev$empty = exist(" empty")
dataRev$soggy = exist(" soggy")
dataRev$dry = exist(" dry")
dataRev$awful = exist(" awful")
dataRev$at_all = exist(" at all")
dataRev$oily = exist(" oily")
dataRev$although = exist(" although")
dataRev$ok = exist(" (ok|alright)")
dataRev$stay_away = exist(" stay away")
dataRev$embarrassing = exist(" embarrassing")
dataRev$potential = exist(" potential")
dataRev$mislead = exist(" mislead")
dataRev$yuck = exist(" yuck")
dataRev$grumpy = exist(" grumpy")
dataRev$early = exist(" early")
dataRev$tried = exist(" tried")
dataRev$complain = exist(" complain(ed|t|s)?")
dataRev$joint = exist(" joint")
dataRev$hard = exist(" hard")
dataRev$take_long = exist(" takes? long")
dataRev$oh_well = exist(" oh* well")
dataRev$shabby = exist(" shabby")
dataRev$barely = exist(" barely")
dataRev$boo = exist(" boo")
dataRev$crap = exist(" crap")
dataRev$refill = exist(" refill[s|ed|ing]?")
dataRev$refuse = exist(" refuse?")
dataRev$unbelievable = exist(" unbelievable")
dataRev$price = exist(" price")
dataRev$not_be_back = exist("(not be|wont be|wont go|not go) back")
dataRev$expensive = exist("[^(in|not)]expensive")
dataRev$dont_expect = exist("(dont|not) expect")
dataRev$cant_go_wrong = exist("t go wrong")
dataRev$used_to = exist(" used to")
dataRev$mess = exist(" mess(y|ed)?")
dataRev$not_even = exist("(cant|not|wouldnt|wont|dont|shouldnt|shant) even")
dataRev$smiley = exist("(\\(:|:\\)|:D)")
dataRev$not_fail = exist(" (not|without|never|ever) fail")

save(dataRev, file = "../data/dataRev.rda")