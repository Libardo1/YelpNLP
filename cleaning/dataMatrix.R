load("../data/review.rda")

# All-lowercase variant of data.rda for ease in matching strings
dataLower = tolower(data$text)

# Helper function that returns the count of appearances of a string
count = function(x, text) {
  sapply(text, function(y) sum(gregexpr(x, y)[[1]] > 0))
}

# Helper function that returns whether or not a string appears
exist = function(x) {
  as.factor(grepl(x, dataLower))
}

dataRough = data.frame(rating = data$starsF)
dataRough$delicious = exist(" deli(cious|sh)")
dataRough$friendly = exist(" friendly")
dataRough$affordable = exist(" affordable")
dataRough$filled = exist(" f[ui]ll")
dataRough$best = exist("[^(not|far from)]( the)? best")
dataRough$awesome = exist(" awesome")
dataRough$huge = exist(" huge")
dataRough$good = exist(" good")
dataRough$wonderful = exist(" wonderful")
dataRough$mom = exist(" mom")
dataRough$thanks = exist(" thanks")
dataRough$like = exist(" like")
dataRough$refreshing = exist(" refreshing")
dataRough$homestyle = exist("home[- ]?(cooked|made|style)")
dataRough$love = exist(" love")
dataRough$enjoy = exist(" enjoy")
dataRough$glad = exist(" glad")
dataRough$nice = exist(" nice")
dataRough$tasty = exist(" tasty")
dataRough$relax = exist(" relax")
dataRough$excellent = exist(" excellent")
dataRough$accomodate = exist(" accomodat(ed|ing)")
dataRough$exclamation = count("!", dataLower) / count("[\\.!]", dataLower)
dataRough$topnotch = exist(" top[- ]?notch")
dataRough$welcome = exist(" welcom(e|ed|ing)")
dataRough$memories = exist(" memories")
dataRough$fond = exist(" fond ")
dataRough$uppercase = count("[[:upper:]]", data$text) / count("[[:alpha:]]", dataLower)
dataRough$crispy = exist(" crispy")
dataRough$happyhour = exist(" happy[- ]?hour")
dataRough$great = exist(" great")
dataRough$handsdown = exist(" hands[- ]?down")
dataRough$colddrinks = exist("cold (beer|drinks|beverages)")
dataRough$engaging = exist(" engaging")
dataRough$quickly = exist(" quick(ly)?")
dataRough$bigscreen = exist(" big[- ]?screen")
dataRough$free = exist(" free")
dataRough$clean = exist(" clean")
dataRough$pleasing = exist(" pleasing")
dataRough$endless = exist(" endless")
dataRough$highly = exist(" highly")
dataRough$convenient = exist(" convenient")
dataRough$packed = exist(" packed")
dataRough$hungry = exist(" (hungry|starving|famished)")
dataRough$favorite = exist(" favorite")
dataRough$hot = exist(" hot")
dataRough$surprising = exist(" surprising")
dataRough$fresh = exist(" fresh")
dataRough$cheap = exist(" cheap")
dataRough$thank = exist(" thank")
dataRough$yum = exist(" (yum|nom)")
dataRough$happy = exist(" (happy|satisfied)")
dataRough$a_must = exist("a must")
dataRough$overflow = exist(" overflow")
dataRough$busy = exist(" busy")
dataRough$classy = exist(" classy")
dataRough$healthy = exist(" healthy")
dataRough$five_star = exist("(five|5)[- ]?(star|out|/5)")
dataRough$four_star = exist("(four|4)[- ]?(star|out|/5)")
dataRough$three_star = exist("(three|3)[- ]?(star|out|/5)")
dataRough$two_star = exist("(two|2)[- ]?(star|out|/5)")
dataRough$one_star = exist("(one|1)[- ]?(star|out|/5)")
dataRough$regular = exist(" regular")
dataRough$crumb = exist(" crumb")
dataRough$real_butter = exist(" real butter")
dataRough$advice = exist(" advi[sc]e")
dataRough$cant_wait = exist(" (cant|cannot|couldnt|not) wait")
dataRough$unpretentious = exist("unpretentious")
dataRough$exactly = exist("exactly")
dataRough$rich = exist(" rich[,\\. ]")
dataRough$free_parking = exist("(plenty|of|free) parking")
dataRough$attentive = exist("[^(in|not |un)]attentive")
dataRough$pleasant = exist("[^(not |un)]pleasant")
dataRough$efficient = exist("[^(not |in)]efficient")
dataRough$outstanding = exist(" outstanding")
dataRough$flavorful = exist(" flavorful")
dataRough$fabulous = exist(" fabulous")
dataRough$local = exist(" local")
dataRough$perfect = exist("perfect")
dataRough$ambience = exist(" ambi[ae]n(ce|t)")
dataRough$totally = exist("totally")
dataRough$worth = exist("[^(not)] worth")
dataRough$world = exist(" world")
dataRough$nostalgia = exist(" nostalgia")
dataRough$wifi = exist(" wi[- ]?fi")
dataRough$gem = exist(" gem")
dataRough$recommend = exist("recommend")
dataRough$juicy = exist(" juicy")
dataRough$authentic = exist(" authentic")
dataRough$amazing = exist("amazing")
dataRough$plague = exist("plague")
dataRough$popular = exist("[^(not |un)]popular")
dataRough$atmosphere = exist(" atmosphere")
dataRough$late = exist(" late")
dataRough$consistent = exist("[^(not |in)]consistent")
dataRough$tip = exist(" tip")
dataRough$impress = exist(" impress")
dataRough$fantastic = exist("fantastic")
dataRough$cozy = exist("cozy")
dataRough$atmosphere = exist(" atmosphere")
dataRough$beautiful = exist("beautiful")
dataRough$forever = exist("forever")
dataRough$tender = exist("tender[^s]")
dataRough$aroma = exist("aroma")
dataRough$charming = exist("charming")
dataRough$reasonable = exist("[^(not |un)]reasonabl[ey]")
dataRough$clean = exist("[^(not |un)]clean")
dataRough$cash_only = exist(" cash[- ]?only")
dataRough$close = exist(" clos(e|ed|ing)")
dataRough$hit = exist(" hit.*miss")
dataRough$enough = exist(" enough")
dataRough$hate = exist(" hate")
dataRough$lack = exist(" lack")
dataRough$worst = exist(" wors[te]")
dataRough$disappoint = exist(" disappoint(ment|ing)")
dataRough$understaff = exist(" understaff")
dataRough$ridiculous = exist(" ridiculous")
dataRough$dissatisfied = exist(" dissatisfied")
dataRough$dirty = exist(" dirty")
dataRough$ellips2s = exist("\\.\\.\\.*")
dataRough$terrible = exist(" terrible")
dataRough$average = exist(" average")
dataRough$inferior = exist(" inferior")
dataRough$canned = exist(" canned")
dataRough$grease = exist(" greas[ey]")
dataRough$disgusting = exist(" disgust[ing|ed]?")
dataRough$only = exist(" only")
dataRough$bad = exist(" bad")
dataRough$typical = exist(" typical")
dataRough$never = exist(" never")
dataRough$another_try = exist(" (another|more|second) (try|chance)")
dataRough$long = exist(" long")
dataRough$clue = exist(" clue")
dataRough$nah = exist("nah")
dataRough$tiny = exist(" tiny")
dataRough$naive = exist("naive")
dataRough$slow = exist(" slow")
dataRough$noisy = exist(" noisy")
dataRough$however = count(" (however|but|though|although)", dataLower)
dataRough$drawback = exist(" drawback")
dataRough$cooked = exist(" [^(under)]cook[ed]?")
dataRough$no_bathroom = exist(" no ((bath|rest|wash)room|toilet)")
dataRough$cramped = exist(" cramped")
dataRough$undercook = exist(" undercook[ed]?")
dataRough$raw = exist(" raw")
dataRough$unfortunate = exist(" unfortunate")
dataRough$not_worth = exist(" not worth")
dataRough$small = exist(" small")
dataRough$grimy = exist(" (gr|sl)imy")
dataRough$dark = exist(" dark")
dataRough$hole = exist(" hole")
dataRough$stand = exist(" stand")
dataRough$plain = exist(" plain")
dataRough$rude = exist(" rude")
dataRough$decent = exist(" decent")
dataRough$nothing_special = exist(" n[[:alpha:]]* special")
dataRough$boring = exist(" boring")
dataRough$avoid = exist(" avoid")
dataRough$filthy = exist(" filthy")
dataRough$unable = exist(" unable")
dataRough$overX = exist(" over[[:alpha:]]*")
dataRough$confusing = exist(" confus(ing|ed)")
dataRough$yell = exist(" yell")
dataRough$no = exist(" no ")
dataRough$at_best = exist(" at best")
dataRough$horrible = exist(" horrible")
dataRough$sadface = exist("(-_+-|\\):|:\\(|D:)")
dataRough$waste = exist(" waste")
dataRough$tasteless = exist(" tasteless")
dataRough$cold = exist(" cold")
dataRough$tasteless = exist(" tasteless")
dataRough$empty = exist(" empty")
dataRough$soggy = exist(" soggy")
dataRough$dry = exist(" dry")
dataRough$awful = exist(" awful")
dataRough$at_all = exist(" at all")
dataRough$oily = exist(" oily")
dataRough$although = exist(" although")
dataRough$ok = exist(" (ok|alright)")
dataRough$stay_away = exist(" stay away")
dataRough$embarrassing = exist(" embarrassing")
dataRough$potential = exist(" potential")
dataRough$mislead = exist(" mislead")
dataRough$yuck = exist(" yuck")
dataRough$grumpy = exist(" grumpy")
dataRough$early = exist(" early")
dataRough$tried = exist(" tried")
dataRough$complain = exist(" complain(ed|t|s)?")
dataRough$joint = exist(" joint")
dataRough$hard = exist(" hard")
dataRough$take_long = exist(" takes? long")
dataRough$oh_well = exist(" oh* well")
dataRough$shabby = exist(" shabby")
dataRough$barely = exist(" barely")
dataRough$boo = exist(" boo")
dataRough$crap = exist(" crap")
dataRough$refill = exist(" refill[s|ed|ing]?")
dataRough$refuse = exist(" refuse?")
dataRough$unbelievable = exist(" unbelievable")
dataRough$price = exist(" price")
dataRough$not_be_back = exist("(not be|wont be|wont go|not go) back")
dataRough$expensive = exist("[^(in|not)]expensive")
dataRough$dont_expect = exist("(dont|not) expect")
dataRough$cant_go_wrong = exist("t go wrong")
dataRough$used_to = exist(" used to")
dataRough$mess = exist(" mess(y|ed)?")
dataRough$not_even = exist("(cant|not|wouldnt|wont|dont|shouldnt|shant) even")
dataRough$smiley = exist("(\\(:|:\\)|:D)")
dataRough$not_fail = exist(" (not|without|never|ever) fail")

save(dataRough, file = "../data/dataRough.rda")