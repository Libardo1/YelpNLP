load("train.rda")

# All-lowercase variant of train.rda for ease in matching strings
trainLower = tolower(train$text)

# Helper function that returns the count of appearances of a string
count = function(x, text) {
  sapply(text, function(y) sum(gregexpr(x, y)[[1]] > 0))
}

# Helper function that returns whether or not a string appears
exist = function(x) {
  as.factor(grepl(x, trainLower))
}

data = data.frame(rating = train$starsF)
data$delicious = exist(" deli(cious|sh)")
data$friendly = exist(" friendly")
data$affordable = exist(" affordable")
data$filled = exist(" f[ui]ll")
data$best = exist("[^(not|far from)]( the)? best")
data$awesome = exist(" awesome")
data$huge = exist(" huge")
data$good = exist(" good")
data$wonderful = exist(" wonderful")
data$mom = exist(" mom")
data$thanks = exist(" thanks")
data$like = exist(" like")
data$refreshing = exist(" refreshing")
data$homestyle = exist("home[- ]?(cooked|made|style)")
data$love = exist(" love")
data$enjoy = exist(" enjoy")
data$glad = exist(" glad")
data$nice = exist(" nice")
data$tasty = exist(" tasty")
data$relax = exist(" relax")
data$excellent = exist(" excellent")
data$accomodate = exist(" accomodat(ed|ing)")
data$exclamation = count("!", trainLower) / count("[\\.!]", trainLower)
data$topnotch = exist(" top[- ]?notch")
data$welcome = exist(" welcom(e|ed|ing)")
data$memories = exist(" memories")
data$fond = exist(" fond ")
data$uppercase = count("[[:upper:]]", train$text) / count("[[:alpha:]]", trainLower)
data$crispy = exist(" crispy")
data$happyhour = exist(" happy[- ]?hour")
data$great = exist(" great")
data$handsdown = exist(" hands[- ]?down")
data$colddrinks = exist("cold (beer|drinks|beverages)")
data$engaging = exist(" engaging")
data$quickly = exist(" quick(ly)?")
data$bigscreen = exist(" big[- ]?screen")
data$free = exist(" free")
data$clean = exist(" clean")
data$pleasing = exist(" pleasing")
data$endless = exist(" endless")
data$highly = exist(" highly")
data$convenient = exist(" convenient")
data$packed = exist(" packed")
data$hungry = exist(" (hungry|starving|famished)")
data$favorite = exist(" favorite")
data$hot = exist(" hot")
data$surprising = exist(" surprising")
data$fresh = exist(" fresh")
data$cheap = exist(" cheap")
data$thank = exist(" thank")
data$yum = exist(" (yum|nom)")
data$happy = exist(" (happy|satisfied)")
data$a_must = exist("a must")
data$overflow = exist(" overflow")
data$busy = exist(" busy")
data$classy = exist(" classy")
data$healthy = exist(" healthy")
data$five_star = exist("(five|5)[- ]?(star|out|/5)")
data$four_star = exist("(four|4)[- ]?(star|out|/5)")
data$three_star = exist("(three|3)[- ]?(star|out|/5)")
data$two_star = exist("(two|2)[- ]?(star|out|/5)")
data$one_star = exist("(one|1)[- ]?(star|out|/5)")
data$regular = exist(" regular")
data$crumb = exist(" crumb")
data$real_butter = exist(" real butter")
data$advice = exist(" advi[sc]e")
data$cant_wait = exist(" (cant|cannot|couldnt|not) wait")
data$unpretentious = exist("unpretentious")
data$exactly = exist("exactly")
data$rich = exist(" rich[,\\. ]")
data$free_parking = exist("(plenty|of|free) parking")
data$attentive = exist("[^(in|not |un)]attentive")
data$pleasant = exist("[^(not |un)]pleasant")
data$efficient = exist("[^(not |in)]efficient")
data$outstanding = exist(" outstanding")
data$flavorful = exist(" flavorful")
data$fabulous = exist(" fabulous")
data$local = exist(" local")
data$perfect = exist("perfect")
data$ambience = exist(" ambi[ae]n(ce|t)")
data$totally = exist("totally")
data$worth = exist("[^(not)] worth")
data$world = exist(" world")
data$nostalgia = exist(" nostalgia")
data$wifi = exist(" wi[- ]?fi")
data$gem = exist(" gem")
data$recommend = exist("recommend")
data$juicy = exist(" juicy")
data$authentic = exist(" authentic")
data$amazing = exist("amazing")
data$plague = exist("plague")
data$popular = exist("[^(not |un)]popular")
data$atmosphere = exist(" atmosphere")
data$late = exist(" late")
data$consistent = exist("[^(not |in)]consistent")
data$tip = exist(" tip")
data$impress = exist(" impress")
data$fantastic = exist("fantastic")
data$cozy = exist("cozy")
data$atmosphere = exist(" atmosphere")
data$beautiful = exist("beautiful")
data$forever = exist("forever")
data$tender = exist("tender[^s]")
data$aroma = exist("aroma")
data$charming = exist("charming")
data$reasonable = exist("[^(not |un)]reasonabl[ey]")
data$clean = exist("[^(not |un)]clean")
data$cash_only = exist(" cash[- ]?only")
data$close = exist(" clos(e|ed|ing)")
data$hit = exist(" hit.*miss")
data$enough = exist(" enough")
data$hate = exist(" hate")
data$lack = exist(" lack")
data$worst = exist(" wors[te]")
data$disappoint = exist(" disappoint(ment|ing)")
data$understaff = exist(" understaff")
data$ridiculous = exist(" ridiculous")
data$dissatisfied = exist(" dissatisfied")
data$dirty = exist(" dirty")
data$ellips2s = exist("\\.\\.\\.*")
data$terrible = exist(" terrible")
data$average = exist(" average")
data$inferior = exist(" inferior")
data$canned = exist(" canned")
data$grease = exist(" greas[ey]")
data$disgusting = exist(" disgust[ing|ed]?")
data$only = exist(" only")
data$bad = exist(" bad")
data$typical = exist(" typical")
data$never = exist(" never")
data$another_try = exist(" (another|more|second) (try|chance)")
data$long = exist(" long")
data$clue = exist(" clue")
data$nah = exist("nah")
data$tiny = exist(" tiny")
data$naive = exist("naive")
data$slow = exist(" slow")
data$noisy = exist(" noisy")
data$however = count(" (however|but|though|although)", trainLower)
data$drawback = exist(" drawback")
data$cooked = exist(" [^(under)]cook[ed]?")
data$no_bathroom = exist(" no ((bath|rest|wash)room|toilet)")
data$cramped = exist(" cramped")
data$undercook = exist(" undercook[ed]?")
data$raw = exist(" raw")
data$unfortunate = exist(" unfortunate")
data$not_worth = exist(" not worth")
data$small = exist(" small")
data$grimy = exist(" (gr|sl)imy")
data$dark = exist(" dark")
data$hole = exist(" hole")
data$stand = exist(" stand")
data$plain = exist(" plain")
data$rude = exist(" rude")
data$decent = exist(" decent")
data$nothing_special = exist(" n[[:alpha:]]* special")
data$boring = exist(" boring")
data$avoid = exist(" avoid")
data$filthy = exist(" filthy")
data$unable = exist(" unable")
data$overX = exist(" over[[:alpha:]]*")
data$confusing = exist(" confus(ing|ed)")
data$yell = exist(" yell")
data$no = exist(" no ")
data$at_best = exist(" at best")
data$horrible = exist(" horrible")
data$sadface = exist("(-_+-|\\):|:\\(|D:)")
data$waste = exist(" waste")
data$tasteless = exist(" tasteless")
data$cold = exist(" cold")
data$tasteless = exist(" tasteless")
data$empty = exist(" empty")
data$soggy = exist(" soggy")
data$dry = exist(" dry")
data$awful = exist(" awful")
data$at_all = exist(" at all")
data$oily = exist(" oily")
data$although = exist(" although")
data$ok = exist(" (ok|alright)")
data$stay_away = exist(" stay away")
data$embarrassing = exist(" embarrassing")
data$potential = exist(" potential")
data$mislead = exist(" mislead")
data$yuck = exist(" yuck")
data$grumpy = exist(" grumpy")
data$early = exist(" early")
data$tried = exist(" tried")
data$complain = exist(" complain(ed|t|s)?")
data$joint = exist(" joint")
data$hard = exist(" hard")
data$take_long = exist(" takes? long")
data$oh_well = exist(" oh* well")
data$shabby = exist(" shabby")
data$barely = exist(" barely")
data$boo = exist(" boo")
data$crap = exist(" crap")
data$refill = exist(" refill[s|ed|ing]?")
data$refuse = exist(" refuse?")
data$unbelievable = exist(" unbelievable")
data$price = exist(" price")
data$not_be_back = exist("(not be|wont be|wont go|not go) back")
data$expensive = exist("[^(in|not)]expensive")
data$dont_expect = exist("(dont|not) expect")
data$cant_go_wrong = exist("t go wrong")
data$used_to = exist(" used to")
data$mess = exist(" mess(y|ed)?")
data$not_even = exist("(cant|not|wouldnt|wont|dont|shouldnt|shant) even")
data$smiley = exist("(\\(:|:\\)|:D)")
data$not_fail = exist(" (not|without|never|ever) fail")

save(data, file = "data.rda")