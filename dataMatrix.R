load("train.rda")

trainLower = tolower(train$text)

count = function(x) {
  sapply(trainLower, function(y) length(gregexpr(x, y)[[1]]))
}

exist = function(x) {
  grepl(x, trainLower)
}

data = data.frame(
  "rating" = train$starsF,
  "delicious" = exist(" deli(cious|sh)"),
  "friendly" = exist(" friendly"),
  "affordable" = exist(" affordable"),
  "filled" = exist(" f[ui]ll"),
  "best" = count(" best"),
  "awesome" = count(" awesome"),
  "huge" = count(" huge"),
  "good" = count(" good"),
  "wonderful" = count(" wonderful"),
  "mom" = exist(" mom"),
  "thanks" = exist(" thanks"),
  "like" = count(" like"),
  "refreshing" = exist(" refreshing"),
  "homestyle" = exist("home[- ]?(cooked|made|style)"),
  "love" = count(" love"),
  "enjoy" = count(" enjoy"),
  "glad" = exist(" glad"),
  "nice" = count(" nice"),
  "tasty" = exist(" tasty"),
  "relax" = exist(" relax"),
  "excellent" = count(" excellent"),
  "accomodate" = exist(" accomodat(ed|ing)"),
  "exclamation" = count("!"),
  "topnotch" = exist(" top[- ]?notch"),
  "welcome" = exist(" welcom(e|ed|ing)"),
  "memories" = exist(" memories"),
  "fond" = exist(" fond "),
  "uppercase" = sapply(train$text, function(x) length(gregexpr("[[:upper:]]"))),
  "crispy" = exist(" crispy"),
  "happyhour" = exist(" happy[- ]?hour"),
  "great" = count(" great"),
  "handsdown" = exist(" hands[- ]?down"),
  "colddrinks" = exist("cold (beer|drinks|beverages)"),
  "engaging" = exist(" engaging"),
  "quickly" = exist(" quick(ly)?"),
  "bigscreen" = exist(" big[- ]?screen"),
  "free" = exist(" free"),
  "clean" = exist(" clean"),
  "pleasing" = exist(" pleasing"),
  "endless" = exist(" endless"),
  "highly" = exist(" highly"),
  "convenient" = exist(" convenient"),
  "atmosphere" = exist(" atmosphere"),
  "packed" = exist(" packed"),
  "hungry" = exist(" (hungry|starving|famished)"),
  "favorite" = count(" favorite"),
  "hot" = exist(" hot"),
  "surprising" = exist(" surprising"),
  "fresh" = count(" fresh"),
  "cheap" = count(" cheap"),
  "thank" = count(" thank"),
  "yum" = count(" (yum|nom)"),
  "happy" = count(" (happy|satisfied)"),
  "a_must" = exist("a must"),
  "overflow" = exist(" overflow"),
  "busy" = exist(" busy"),
  "classy" = exist(" classy"),
  "healthy" = exist(" healthy"),
  "5_star" = exist("5[- ]?(stars?|out|/5)"),
  "4_star" = exist("4[- ]?(stars?|out|/5)"),
  "3_star" = exist("3[- ]?(stars?|out|/5)"),
  "2_star" = exist("2[- ]?(stars?|out|/5)"),
  "1_star" = exist("1[- ]?(stars?|out|/5)"),
  "regular" = exist(" regular"),
  "crumb" = exist(" crumb"),
  "real_butter" = exist(" real butter"),
  "advice" = exist(" advi[sc]e"),
  "cant_wait" = exist(" (cant|cannot|couldnt|not) wait"),
  "unpretentious" = exist("unpretentious"),
  "exactly" = exist("exactly"),
  "rich" = sapply(train$text, function(x) length(gregexpr(" rich[,\\. ]"))),
  "free_parking" = exist("(plenty|of|free) parking"),
  "attentive" = exist("[^(in|not |un)]attentive"),
  "pleasant" = exist("[^(not |un)]pleasant"),
  "efficient" = exist("[^(not |in)]efficient"),
  "outstanding" = count(" outstanding"),
  "flavorful" = exist(" flavorful"),
  "fabulous" = exist(" fabulous"),
  "local" = exist(" local"),
  "perfect" = count("perfect"),
  "ambience" = exist(" ambi[ae]n(ce|t)"),
  "totally" = count("totally"),
  "worth" = count("[^(not)] worth"),
  "world" = exist(" world"),
  "nostalgia" = exist(" nostalgia"),
  "wifi" = exist(" wi[- ]?fi"),
  "gem" = exist(" gem"),
  "recommend" = count("recommend"),
  "juicy" = exist(" juicy"),
  "authentic" = exist(" authentic"),
  "amazing" = count("amazing"),
  "plague" = exist("plague"),
  "popular" = exist("[^(not |un)]popular"),
  "atmosphere" = exist(" atmosphere"),
  "late" = exist(" late"),
  "consistent" = exist("[^(not |in)]consistent"),
  "tip" = exist(" tip"),
  "impress" = exist(" impress"),
  "fantastic" = count("fantastic"),
  "cozy" = exist("cozy"),
  "beautiful" = exist("beautiful"),
  "forever" = exist("forever"),
  "tender" = exist("tender[^s]"),
  "aroma" = exist("aroma"),
  "charming" = exist("charming"),
  "reasonable" = exist("[^(not |un)]reasonabl[ey]"),
  "clean" = exist("[^(not |un)]clean"),
  "cash only" = exist(" cash[- ]?only"),
  "close" = exist(" clos(e|ed|ing)"),
  "hit" = exist(" hit.*miss"),
  "enough" = exist(" enough"),
  "hate" = exist(" hate"),
  "lack" = exist(" lack"),
  "worst" = count(" wors[te]"),
  "disappoint" = count(" disappoint(ment|ing)"),
  "understaff" = exist(" understaff"),
  "ridiculous" = exist(" ridiculous"),
  "dissatisfied" = exist(" dissatisfied"),
  "dirty" = exist(" dirty"),
  "ellipsis" = exist("...*"),
  "terrible" = count(" terrible"),
  "average" = count(" average"),
  "inferior" = exist(" inferior"),
  "canned" = exist(" canned"),
  "grease" = exist(" greas[ey]"),
  "disgusting" = exist(" disgust[ing|ed]?"),
  "only" = count(" only"),
  "bad" = count(" bad"),
  "typical" = count(" typical"),
  "never" = count(" never"),
  "another_try" = exist(" (another|more|second) (try|chance)"),
  "long" = exist(" long"),
  "clue" = exist(" clue"),
  "nah" = exist("nah"),
  "tiny" = count(" tiny"),
  "naive" = exist("naive"),
  "slow" = count(" slow"),
  "noisy" = exist(" noisy"),
  "however" = count(" (however|but|though|although)"),
  "drawback" = exist(" drawback"),
  "cooked" = exist(" [^(under)]cook[ed]?"),
  "no_bathroom" = exist(" no_((bath|rest|wash)room|toilet)"),
  "cramped" = exist(" cramped"),
  "undercook" = exist(" undercook[ed]?"),
  "raw" = exist(" raw"),
  "unfortunate" = exist(" unfortunate"),
  "not_worth" = exist(" not worth"),
  "small" = exist(" small"),
  "grimy" = exist(" (gr|sl)imy"),
  "dark" = exist(" dark"),
  "hole" = exist(" hole"),
  "stand" = count(" stand"),
  "plain" = count(" plain"),
  "rude" = count(" rude"),
  "decent" = exist(" decent"),
  "nothing_special" = exist(" n[[:alpha:]]* special"),
  "boring" = exist(" boring"),
  "avoid" = count(" avoid"),
  "filthy" = exist(" filthy"),
  "unable" = exist(" unable"),
  "overX" = count(" over[[:alpha:]]*"),
  "confusing" = exist(" confus(ing|ed)"),
  "yell" = exist(" yell"),
  "no" = count(" no "),
  "at best" = exist(" at best"),
  "horrible" = exist(" horrible"),
  "-_-" = exist(" -_+-"),
  "waste" = exist(" waste"),
  "tasteless" = exist(" tasteless"),
  "cold" = exist(" cold"),
  "tasteless" = exist(" tasteless"),
  "empty" = exist(" empty"),
  "soggy" = exist(" soggy"),
  "dry" = exist(" dry"),
  "awful" = count(" awful"),
  "at all" = count(" at all"),
  "oily" = exist(" oily"),
  "although" = exist(" although"),
  "ok" = count(" ok"),
  "stay away" = exist(" stay away"),
  "embarrassing" = exist(" embarrassing"),
  "potential" = exist(" potential"),
  "mislead" = exist(" mislead"),
  "yuck" = exist(" yuck"),
  "grumpy" = exist(" grumpy"),
  "early" = exist(" early"),
  "tried" = exist(" tried"),
  "complain" = exist(" complain(ed|t|s)?"),
  "fail" = count(" fail"),
  "joint" = exist(" joint"),
  "hard" = count(" hard"),
  "take long" = exist(" takes? long"),
  "oh well" = exist(" oh* well"),
  "shabby" = exist(" shabby"),
  "barely" = exist(" barely"),
  "boo" = count(" boo"),
  "crap" = exist(" crap"),
  "refill" = exist(" refill[s|ed|ing]?"),
  "refuse" = exist(" refuse?"),
  "unbelievable" = exist(" unbelievable"),
  "price" = count(" price"),
  "not_be_back" = exist("(not be|wont be|wont go|not go) back"),
  "expensive" = exist("[^(in|not)]expensive"),
  "dont_expect" = exist("(dont|not) expect"),
  "cant_go_wrong" = exist("t go wrong"),
  "used_to" = exist(" used to"),
  "mess" = exist(" mess(y|ed)?"),
  "not_even" = exist("(cant|not|wouldnt|wont|dont|shouldnt|shant) even"),
  "smiley" = exist("(\\(:|:\\)|:D)")
)