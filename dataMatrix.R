load("train.rda")

trainLower = tolower(train$text)

count = function(x) {
  sapply(trainLower, function(y) length(gregexpr(x, y)[[1]]))
}

exist = function(x) {
  grepl(x, trainLower)
}

data = data.frame(rating = train$starsF)
data$delicious = exist(" deli(cious|sh)")
data$friendly = exist(" friendly")
data$affordable = exist(" affordable")
data$filled = exist(" f[ui]ll")
data$best = count(" best")
data$awesome = count(" awesome")
data$huge = count(" huge")
data$good = count(" good")
data$wonderful = count(" wonderful")
data$mom = exist(" mom")
data$thanks = exist(" thanks")
data$like = count(" like")
data$refreshing = exist(" refreshing")
data$homestyle = exist("home[- ]?(cooked|made|style)")
data$love = count(" love")
data$enjoy = count(" enjoy")
data$glad = exist(" glad")
data$nice = count(" nice")
data$tasty = exist(" tasty")
data$relax = exist(" relax")
data$excellent = count(" excellent")
data$accomodate = exist(" accomodat(ed|ing)")
data$exclamation = count("!")
data$topnotch = exist(" top[- ]?notch")
data$welcome = exist(" welcom(e|ed|ing)")
data$memories = exist(" memories")
data$fond = exist(" fond ")
data$uppercase = sapply(train$text, function(x) length(gregexpr("[[:upper:]]", x)[[1]]))
data$crispy = exist(" crispy")
data$happyhour = exist(" happy[- ]?hour")
data$great = count(" great")
data$handsdown = exist(" hands[- ]?down")
data$colddrinks = exist("cold (beer|drinks|beverages)")
data$engaging = exist(" engaging")
data$quickly = exist(" quick(ly)?")
data$bigscreen = exist(" big[- ]?screen")
data$free = exist(" free")
data$clean = exist(" clean")
data$pleasing = exist(" pleasing")
data$endless = exist(" endless")
data$highly = exist(" highly")
data$convenient = exist(" convenient")
data$atmosphere = exist(" atmosphere")
data$packed = exist(" packed")
data$hungry = exist(" (hungry|starving|famished)")
data$favorite = count(" favorite")
data$hot = exist(" hot")
data$surprising = exist(" surprising")
data$fresh = count(" fresh")
data$cheap = count(" cheap")
data$thank = count(" thank")
data$yum = count(" (yum|nom)")
data$happy = count(" (happy|satisfied)")
data$a_must = exist("a must")
data$overflow = exist(" overflow")
data$busy = exist(" busy")
data$classy = exist(" classy")
data$healthy = exist(" healthy")
data$five_star = exist("(five|5)[- ]?(star|out|/5)")
data$four_star = exist("(four|4)[- ]?(star|out|/5)")
data$three_star = exist("(three|3)[- ]?(star|out|/5)")
data$two_star = exist("(two|2)[- ]?(star|out|/5)")
data$one_star = exist("(one|1)[- ]?(star|out|/5)")
data$regular = exist(" regular")
data$crumb = exist(" crumb")
data$real_butter = exist(" real butter")
data$advice = exist(" advi[sc]e")
data$cant_wait = exist(" (cant|cannot|couldnt|not) wait")
data$unpretentious = exist("unpretentious")
data$exactly = exist("exactly")
data$rich = sapply(train$text, function(x) length(gregexpr(" rich[,\\. ]", x)[[1]]))
data$free_parking = exist("(plenty|of|free) parking")
data$attentive = exist("[^(in|not |un)]attentive")
data$pleasant = exist("[^(not |un)]pleasant")
data$efficient = exist("[^(not |in)]efficient")
data$outstanding = count(" outstanding")
data$flavorful = exist(" flavorful")
data$fabulous = exist(" fabulous")
data$local = exist(" local")
data$perfect = count("perfect")
data$ambience = exist(" ambi[ae]n(ce|t)")
data$totally = count("totally")
data$worth = count("[^(not)] worth")
data$world = exist(" world")
data$nostalgia = exist(" nostalgia")
data$wifi = exist(" wi[- ]?fi")
data$gem = exist(" gem")
data$recommend = count("recommend")
data$juicy = exist(" juicy")
data$authentic = exist(" authentic")
data$amazing = count("amazing")
data$plague = exist("plague")
data$popular = exist("[^(not |un)]popular")
data$atmosphere = exist(" atmosphere")
data$late = exist(" late")
data$consistent = exist("[^(not |in)]consistent")
data$tip = exist(" tip")
data$impress = exist(" impress")
data$fantastic = count("fantastic")
data$cozy = exist("cozy")
data$beautiful = exist("beautiful")
data$forever = exist("forever")
data$tender = exist("tender[^s]")
data$aroma = exist("aroma")
data$charming = exist("charming")
data$reasonable = exist("[^(not |un)]reasonabl[ey]")
data$clean = exist("[^(not |un)]clean")
data$cash_only = exist(" cash[- ]?only")
data$close = exist(" clos(e|ed|ing)")
data$hit = exist(" hit.*miss")
data$enough = exist(" enough")
data$hate = exist(" hate")
data$lack = exist(" lack")
data$worst = count(" wors[te]")
data$disappoint = count(" disappoint(ment|ing)")
data$understaff = exist(" understaff")
data$ridiculous = exist(" ridiculous")
data$dissatisfied = exist(" dissatisfied")
data$dirty = exist(" dirty")
data$ellipsis = exist("...*")
data$terrible = count(" terrible")
data$average = count(" average")
data$inferior = exist(" inferior")
data$canned = exist(" canned")
data$grease = exist(" greas[ey]")
data$disgusting = exist(" disgust[ing|ed]?")
data$only = count(" only")
data$bad = count(" bad")
data$typical = count(" typical")
data$never = count(" never")
data$another_try = exist(" (another|more|second) (try|chance)")
data$long = exist(" long")
data$clue = exist(" clue")
data$nah = exist("nah")
data$tiny = count(" tiny")
data$naive = exist("naive")
data$slow = count(" slow")
data$noisy = exist(" noisy")
data$however = count(" (however|but|though|although)")
data$drawback = exist(" drawback")
data$cooked = exist(" [^(under)]cook[ed]?")
data$no_bathroom = exist(" no_((bath|rest|wash)room|toilet)")
data$cramped = exist(" cramped")
data$undercook = exist(" undercook[ed]?")
data$raw = exist(" raw")
data$unfortunate = exist(" unfortunate")
data$not_worth = exist(" not worth")
data$small = exist(" small")
data$grimy = exist(" (gr|sl)imy")
data$dark = exist(" dark")
data$hole = exist(" hole")
data$stand = count(" stand")
data$plain = count(" plain")
data$rude = count(" rude")
data$decent = exist(" decent")
data$nothing_special = exist(" n[[:alpha:]]* special")
data$boring = exist(" boring")
data$avoid = count(" avoid")
data$filthy = exist(" filthy")
data$unable = exist(" unable")
data$overX = count(" over[[:alpha:]]*")
data$confusing = exist(" confus(ing|ed)")
data$yell = exist(" yell")
data$no = count(" no ")
data$at_best = exist(" at best")
data$horrible = exist(" horrible")
data$sadface = exist("(-_+-|\\):|:\\(|D:)")
data$waste = exist(" waste")
data$tasteless = exist(" tasteless")
data$cold = exist(" cold")
data$tasteless = exist(" tasteless")
data$empty = exist(" empty")
data$soggy = exist(" soggy")
data$dry = exist(" dry")
data$awful = count(" awful")
data$at_all = count(" at all")
data$oily = exist(" oily")
data$although = exist(" although")
data$ok = count(" ok")
data$stay_away = exist(" stay away")
data$embarrassing = exist(" embarrassing")
data$potential = exist(" potential")
data$mislead = exist(" mislead")
data$yuck = exist(" yuck")
data$grumpy = exist(" grumpy")
data$early = exist(" early")
data$tried = exist(" tried")
data$complain = exist(" complain(ed|t|s)?")
data$fail = count(" fail")
data$joint = exist(" joint")
data$hard = count(" hard")
data$take_long = exist(" takes? long")
data$oh_well = exist(" oh* well")
data$shabby = exist(" shabby")
data$barely = exist(" barely")
data$boo = count(" boo")
data$crap = exist(" crap")
data$refill = exist(" refill[s|ed|ing]?")
data$refuse = exist(" refuse?")
data$unbelievable = exist(" unbelievable")
data$price = count(" price")
data$not_be_back = exist("(not be|wont be|wont go|not go) back")
data$expensive = exist("[^(in|not)]expensive")
data$dont_expect = exist("(dont|not) expect")
data$cant_go_wrong = exist("t go wrong")
data$used_to = exist(" used to")
data$mess = exist(" mess(y|ed)?")
data$not_even = exist("(cant|not|wouldnt|wont|dont|shouldnt|shant) even")
data$smiley = exist("(\\(:|:\\)|:D)")

save(data, file = "data.rda")