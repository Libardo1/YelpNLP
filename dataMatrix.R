load("train.rda")

trainLower = tolower(train$text)

data = data.frame(
  "rating" = train$starsF,
  "delicious" = grepl(" deli(cious|sh)", trainLower),
  "friendly" = grepl(" friendly", trainLower),
  "affordable" = grepl(" affordable", trainLower),
  "filled" = grepl(" f[ui]ll", trainLower),
  "best" = sapply(trainLower, function(x) length(gregexpr(" best", x)[[1]])),
  "awesome" = sapply(trainLower, function(x) length(gregexpr(" awesome", x)[[1]])),
  "huge" = sapply(trainLower, function(x) length(gregexpr(" huge", x)[[1]])),
  "good" = sapply(trainLower, function(x) length(gregexpr(" good", x)[[1]])),
  "wonderful" = sapply(trainLower, function(x) length(gregexpr(" wonderful", x)[[1]])),
  "mom" = grepl(" mom", trainLower),
  "thanks" = grepl(" thanks", trainLower),
  "like" = sapply(trainLower, function(x) length(gregexpr(" like", x)[[1]])),
  "refreshing" = grepl(" refreshing", trainLower),
  "homestyle" = grepl("home[- ]?(cooked|made|style)", trainLower),
  "love" = sapply(trainLower, function(x) length(gregexpr(" love", x)[[1]])),
  "enjoy" = sapply(trainLower, function(x) length(gregexpr(" enjoy", x)[[1]])),
  "glad" = grepl(" glad", trainLower),
  "nice" = sapply(trainLower, function(x) length(gregexpr(" nice", x)[[1]])),
  "tasty" = grepl(" tasty", trainLower),
  "relax" = grepl(" relax", trainLower),
  "excellent" = sapply(trainLower, function(x) length(gregexpr(" excellent", x)[[1]])),
  "accomodate" = grepl(" accomodat(ed|ing)", trainLower),
  "exclamation" = sapply(trainLower, function(x) length(gregexpr("!", x)[[1]])),
  "topnotch" = grepl(" top[- ]?notch", trainLower),
  "welcome" = grepl(" welcom(e|ed|ing)", trainLower),
  "memories" = grepl(" memories", trainLower),
  "fond" = grepl(" fond ", trainLower),
  "uppercase" = sapply(train$text, function(x) length(gregexpr("[[:upper:]]", x)[[1]])),
  "crispy" = grepl(" crispy", trainLower),
  "happyhour" = grepl(" happy[- ]?hour", trainLower),
  "great" = sapply(trainLower, function(x) length(gregexpr(" great", x)[[1]])),
  "handsdown" = grepl(" hands[- ]?down", trainLower),
  "colddrinks" = grepl("cold (beer|drinks|beverages)", trainLower),
  "engaging" = grepl(" engaging", trainLower),
  "quickly" = grepl(" quick(ly)?", trainlower),
  "bigscreen" = grepl(" big[- ]?screen", trainLower),
  "free" = grepl(" free", trainLower),
  "clean" = grepl(" clean", trainLower),
  "pleasing" = grepl(" pleasing", trainLower),
  "endless" = grepl(" endless", trainLower),
  "highly" = grepl(" highly", trainLower),
  "convenient" = grepl(" convenient", trainLower),
  "atmosphere" = grepl(" atmosphere", trainLower),
  "packed" = grepl(" packed", trainLower),
  "hungry" = grepl(" (hungry|starving|famished)", trainLower),
  "favorite" = sapply(trainLower, function(x) length(gregexpr(" favorite", x)[[1]])),
  "hot" = grepl(" hot", trainLower),
  "surprising" = grepl(" surprising", trainLower),
  "fresh" = sapply(trainLower, function(x) length(gregexpr(" fresh", x)[[1]])),
  "cheap" = sapply(trainLower, function(x) length(gregexpr(" cheap", x)[[1]])),
  "thank" = sapply(trainLower, function(x) length(gregexpr(" thank", x)[[1]])),
  "yum" = sapply(trainLower, function(x) length(gregexpr(" (yum|nom)", x)[[1]])),
  "happy" = sapply(trainLower, function(x) length(gregexpr(" (happy|satisfied)", x)[[1]])),
  "a_must" = grepl("a must", trainLower),
  "overflow" = grepl(" overflow", trainLower),
  "busy" = grepl(" busy", trainLower),
  "classy" = grepl(" classy", trainLower),
  "healthy" = grepl(" healthy", trainLower),
  "5_star" = grepl("5[- ]?(stars?|out|/5)", trainLower),
  "4_star" = grepl("4[- ]?(stars?|out|/5)", trainLower),
  "3_star" = grepl("3[- ]?(stars?|out|/5)", trainLower),
  "2_star" = grepl("2[- ]?(stars?|out|/5)", trainLower),
  "1_star" = grepl("1[- ]?(stars?|out|/5)", trainLower),
  "regular" = grepl(" regular", trainLower),
  "crumb" = grepl(" crumb", trainLower),
  "real_butter" = grepl(" real butter", trainLower),
  "advice" = grepl(" advi[sc]e", trainLower),
  "cant_wait" = grepl(" (cant|cannot|couldnt|not) wait", trainLower),
  "unpretentious" = grepl("unpretentious", trainLower),
  "exactly" = grepl("exactly", trainLower),
  "rich" = sapply(train$text, function(x) length(gregexpr(" rich[,\\. ]", x)[[1]])),
  "free_parking" = grepl("(plenty|of|free) parking", trainLower),
  "attentive" = grepl("[^(in|not |un)]attentive", trainLower),
  "pleasant" = grepl("[^(not |un)]pleasant", trainLower),
  "efficient" = grepl("[^(not |in)]efficient", trainLower),
  "outstanding" = sapply(trainLower, function(x) length(gregexpr(" outstanding", x)[[1]])),
  "flavorful" = grepl(" flavorful", trainLower),
  "fabulous" = grepl(" fabulous", trainLower),
  "local" = grepl(" local", trainLower),
  "perfect" = sapply(trainLower, function(x) length(gregexpr("perfect", x)[[1]])),
  "ambience" = grepl(" ambi[ae]n(ce|t)", trainLower),
  "totally" = sapply(trainLower, function(x) length(gregexpr("totally", x)[[1]])),
  "worth" = sapply(trainLower, function(x) length(gregexpr("[^(not)] worth", x)[[1]])),
  "world" = grepl(" world", trainLower),
  "nostalgia" = grepl(" nostalgia", trainLower),
  "wifi" = grepl(" wi[- ]?fi", trainLower),
  "gem" = grepl(" gem", trainLower),
  "recommend" = sapply(trainLower, function(x) length(gregexpr("recommend", x)[[1]])),
  "juicy" = grepl(" juicy", trainLower),
  "authentic" = grepl(" authentic", trainLower),
  "amazing" = sapply(trainLower, function(x) length(gregexpr("amazing", x)[[1]])),
  "plague" = grepl("plague", trainLower),
  "popular" = grepl("[^(not |un)]popular", trainLower),
  "atmosphere" = grepl(" atmosphere", trainLower),
  "late" = grepl(" late", trainLower),
  "consistent" = grepl("[^(not |in)]consistent", trainLower),
  "tip" = grepl(" tip", trainLower),
  "impress" = grepl(" impress", trainLower),
  "fantastic" = sapply(trainLower, function(x) length(gregexpr("fantastic", x)[[1]])),
  "cozy" = grepl("cozy", trainLower),
  "beautiful" = grepl("beautiful", trainLower),
  "forever" = grepl("forever", trainLower),
  "tender" = grepl("tender[^s]", trainLower),
  "aroma" = grepl("aroma", trainLower),
  "charming" = grepl("charming", trainLower),
  "reasonable" = grepl("[^(not |un)]reasonabl[ey]", trainLower),
  "clean" = grepl("[^(not |un)]clean", trainLower),
  ""
)